{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/newArrowCheck.js","webpack:///./src/synospecies.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","innerThis","boundThis","TypeError","SparqlEndpoint","constructor","uri","this","_uri","getSparqlResultSet","query","_this","console","log","encodedQuery","encodeURIComponent","fetch","headers","accept","then","response","_babel_runtime_helpers_newArrowCheck__WEBPACK_IMPORTED_MODULE_0___default","ok","json","status","getSparqlRDF","_this2","GraphNode","rdfFetch","Headers","graph","sparqlEndpoint","dwc","localName","$rdf","sym","treat","addedImages","wikidataViewer","element","_this3","_element","innerHTML","classList","remove","_taxonNames","_sparqlEndpoint","_query","taxonName","addTaxon","_this5","wdt","render","gn","_this4","result","out","each","in","about","gbifId","length","Error","reset","document","getElementById","appendImages","taxon","_this10","_this7","_this8","results","bindings","map","binding","url","description","getImages","images","_this11","template","$","html","forEach","image","Mustache","to_html","append","report","genus","species","_this19","names","tns","title","target","_this12","tn","_this13","Promise","all","sort","tn1","tn2","substring","async","_this14","family","f","fs","join","linkToTreatments","_this15","ts","_this16","_this17","links","preferedNameByGN","preferedNameBy","nodes","definingTreatmentGN","definingTreatment","augmentingTreatmentGN","augmentingTreatment","nameSection","lastIndexOf","lastSeparator","replace","RegExp","getFormattedName","deprecationsArea","oldTaxon","_this6","getNewTaxa","newTaxa","_this18","listItems","_this9","getTaxonConcepts","taxonConcepts","window","location","hash","input","lookup","previousValue","gs","cs","ss","toString","indexOf","substr","on","e","undefined","awesomplete","Awesomplete","populateSuggestions","_this21","getGenusSuggestions","getCombinedSuggestions","v","_this22","list","concat","speciesIn","genusIn","getSpeciesSuggestions","values","_this23","_this24","maxItems","onkeyup","addEventListener","wordCount","trim","split","open","filter","foundPos","toLowerCase","item","prefix","_this25","_this26","_this27","_this28","_this29","_this30","suggestion","suggestionSpacePos"],"mappings":"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","file":"synospecies.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","function _newArrowCheck(innerThis, boundThis) {\n  if (innerThis !== boundThis) {\n    throw new TypeError(\"Cannot instantiate an arrow function\");\n  }\n}\n\nmodule.exports = _newArrowCheck;","/* global Mustache, $rdf, fetch, Promise */\n\nclass SparqlEndpoint {\n    constructor(uri) {\n        this._uri = uri;\n    }\n\n    getSparqlResultSet(query) {\n        console.log(query);\n        let encodedQuery = encodeURIComponent(query);\n        return fetch(this._uri + \"?query=\" + encodedQuery, {\n            headers: {\n                accept: \"application/sparql-results+json\"\n            }\n        }).then(response =>\n        {\n            if (!response.ok) {\n                throw response.status;\n            } else {\n                return response.json();\n            }\n        });\n    }\n    \n    getSparqlRDF(query) {\n        console.log(query);\n        let encodedQuery = encodeURIComponent(query);\n        return GraphNode.rdfFetch(this._uri + \"?query=\" + encodedQuery, {\n            headers: new Headers({\n                accept: \"text/turtle\"\n            })\n        }).then(response =>\n        {\n            if (!response.ok) {\n                throw response.status;\n            } else {\n                return response.graph();\n            }\n        });\n    }\n}\n\n\nclass WikidataViewer {\n    \n    \n\n    constructor(element) {\n        this._element = element;\n        element.innerHTML = \"<div>WIKIDATA</div>\";\n        element.classList.remove(\"hide\");\n        this._taxonNames = {};\n        this._sparqlEndpoint = new SparqlEndpoint(\"https://query.wikidata.org/sparql\");\n        this._query = taxonName =>`\n            DESCRIBE ?item WHERE \n            {\n                ?item wdt:P225 \"${taxonName}\"\n            }`;\n    }\n        \n    \n\n    /*$(\"<li>\").append(\"<strong>\" + getFormattedName(tn.value) + \"</strong>\" +\n                        preferedNameBy + \"<br/>\\n\" +\n                        \"Kingdom: \" + tn.out(dwc(\"kingdom\")).value + \" - Phylum: \" + tn.out(dwc(\"phylum\")).value +\n                        \" - Class: \" + tn.out(dwc(\"class\")).value + \" - Order: \" + tn.out(dwc(\"order\")).value +\n                        \" - Family: \" + family + \" - Genus: \" + tn.out(dwc(\"genus\")).value +\n                        \" - Species: \" + tn.out(dwc(\"species\")).value + \"<br/>\" + definingTreatment + \"<br/>\" + augmentingTreatment);*/\n\n    addTaxon(taxonName) {\n        function wdt(localName) {\n            return $rdf.sym(\"http://www.wikidata.org/prop/direct/\" + localName);\n        }\n    \n        function wd(localName) {\n            return $rdf.sym(\"http://www.wikidata.org/entity/\" + localName);\n        }\n\n        function schema(localName) {\n            return $rdf.sym(\"http://schema.org/\" + localName);\n        }\n\n        function render(gn) {\n            let result = \"<div>Wikidata Resource: <a href=\\\"\"+gn.value+\"\\\">\"+gn.value+\"</a>\";\n            result += \"<ul>\"\n            gn.out(wdt(\"P225\")).each(taxonName => {\n                result += \"<li>Taxon Name \"+taxonName.value+\"</li>\";\n            });\n            gn.in(schema(\"about\")).each(about => {\n                result += \"<li>Is subject of: <a href=\\\"\"+about.value+\"\\\">\"+about.value+\"</a></li>\";\n            });\n            gn.out(wdt(\"P846\")).each(gbifId => {\n                result += \"<li>GBIF ID <a href=\\\"https://www.gbif.org/species/\"+gbifId.value+\"\\\">\"+gbifId.value+\"</a></li>\";\n            });\n            result += \"</ul>\"\n            result += \"</div>\"\n            return result;\n        }\n        if (!this._taxonNames[taxonName]) {\n            this._taxonNames[taxonName] = true;\n            return this._sparqlEndpoint.getSparqlRDF(this._query(taxonName)).then(graph => {\n                if (graph.length === 0) {\n                    throw Error(\"Not in wikidata: \"+taxonName);\n                }\n                let tnClass = GraphNode(wd(\"Q16521\"), graph);\n                return tnClass.in(wdt(\"P31\"));\n            }).then(gn => {\n                    this._element.innerHTML = this._element.innerHTML+render(gn);    \n            });\n        }\n    };\n\n    reset() {\n        this._element.innerHTML = \"\";\n    };\n}\n\n\nlet sparqlEndpoint = new SparqlEndpoint(\"https://lindas-data.ch/sparql\");\n//let sparqlEndpoint = \"https://plazi.factsmission.com/plazi/query\";\n\n\nfunction getNewTaxa(oldTaxon) {\n    let query = \"PREFIX treat: <http://plazi.org/vocab/treatment#>\\n\" +\n            \"PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>\\n\" +\n            \"PREFIX dc: <http://purl.org/dc/elements/1.1/>\\n\" +\n            \"CONSTRUCT {\\n\" +\n            \"  ?tc dwc:rank ?rank .\\n\" +\n            \"  ?tc dwc:phylum ?phylum .\\n\" +\n            \"  ?tc dwc:kingdom ?kingdom .\\n\" +\n            \"  ?tc dwc:class ?class .\\n\" +\n            \"  ?tc dwc:family ?family .\\n\" +\n            \"  ?tc dwc:order ?oder .\\n\" +\n            \"  ?tc dwc:genus ?genus .\\n\" +\n            \"  ?tc dwc:species ?species .\\n\" +\n            \"  ?tc a <http://filteredpush.org/ontologies/oa/dwcFP#TaxonConcept> .\\n\" +\n            \"  ?treatment treat:preferedName ?tc.\\n\" +\n            \"  ?treatment dc:creator ?treatmentCreator .\\n\" +\n            \"  ?augmentingTreatment treat:augmentsTaxonConcept ?tc .\\n\" +\n            \"  ?augmentingTreatment dc:creator ?augmentingTreatmentCreator .\" +\n            \"  ?definingTreatment treat:definesTaxonConcept ?tc .\\n\" +\n            \"  ?definingTreatment dc:creator ?definingTreatmentCreator .\\n\" +\n            \"} WHERE { \\n\" +\n            \" GRAPH <https://linked.opendata.swiss/graph/plazi> {\\n\" +\n            \"  ?treatment (treat:augmentsTaxonConcept|treat:definesTaxonConcept) ?tc .\\n\" +\n            \"  ?treatment treat:deprecates <\" + oldTaxon + \">.\\n\" +\n            \"  ?tc dwc:rank ?rank .\\n\" +\n            \"  ?tc dwc:phylum ?phylum .\\n\" +\n            \"  ?tc dwc:kingdom ?kingdom .\\n\" +\n            \"  ?tc dwc:class ?class .\\n\" +\n            \"  ?tc dwc:family ?family .\\n\" +\n            \"  ?tc dwc:order ?oder .\\n\" +\n            \"  ?tc dwc:genus ?genus .\\n\" +\n            \"  ?tc dwc:species ?species .\\n\" +\n            \"  ?treatment ?treatmentTaxonRelation ?tc .\\n\" +\n            \"  ?treatment dc:creator ?treatmentCreator .\\n\" +\n            \"  OPTIONAL { ?augmentingTreatment treat:augmentsTaxonConcept ?tc . \\n\" +\n            \"  ?augmentingTreatment dc:creator ?augmentingTreatmentCreator .}\\n\" +\n            \"  OPTIONAL { ?definingTreatment treat:definesTaxonConcept ?tc . \\n\" +\n            \"  ?definingTreatment dc:creator ?definingTreatmentCreator .}\\n\" +\n            \" }\\n\" +\n            \"} \";\n    return sparqlEndpoint.getSparqlRDF(query).then(graph => {\n        let tnClass = GraphNode($rdf.sym(\"http://filteredpush.org/ontologies/oa/dwcFP#TaxonConcept\"), graph);\n        return tnClass.in($rdf.sym(\"http://www.w3.org/1999/02/22-rdf-syntax-ns#type\"));\n    });\n}\n\n\nfunction getImages(taxon) {\n    let query = \"PREFIX treat: <http://plazi.org/vocab/treatment#>\\n\" +\n            \"PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>\\n\" +\n            \"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\\n\" +\n            \"PREFIX fabio: <http://purl.org/spar/fabio/>\\n\" +\n            \"PREFIX dc: <http://purl.org/dc/elements/1.1/>\\n\" +\n            \"SELECT ?url ?description WHERE {   \\n\" +\n            \"  ?treatment (treat:augmentsTaxonConcept|treat:definesTaxonConcept) <\" + taxon + \"> .\\n\" +\n            \"  ?treatment <http://purl.org/spar/cito/cites> ?cites.\\n\" +\n            \"  ?cites rdf:type fabio:Figure. \\n\" +\n            \"  ?cites fabio:hasRepresentation ?url.\\n\" +\n            \"  ?cites dc:description ?description.  \\n\" +\n            \"} \";\n    return sparqlEndpoint.getSparqlResultSet(query).then(json => {\n        return json.results.bindings.map(binding => {\n            let result = {};\n            result.url = binding.url.value;\n            result.description = binding.description.value;\n            return result;\n        });\n    });\n\n}\n\n\nfunction getTaxonConcepts(genus, species) {\n    let query = \"PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>\\n\" +\n            \"PREFIX treat: <http://plazi.org/vocab/treatment#>\\n\" +\n            \"PREFIX dc: <http://purl.org/dc/elements/1.1/>\\n\" +\n            \"CONSTRUCT {\\n\" +\n            \"  ?tc dwc:rank ?rank .\\n\" +\n            \"  ?tc dwc:phylum ?phylum .\\n\" +\n            \"  ?tc dwc:kingdom ?kingdom .\\n\" +\n            \"  ?tc dwc:class ?class .\\n\" +\n            \"  ?tc dwc:family ?family .\\n\" +\n            \"  ?tc dwc:order ?oder .\\n\" +\n            \"  ?tc dwc:genus \\\"\" + genus + \"\\\" .\\n\" +\n            \"  ?tc dwc:species \\\"\" + species + \"\\\" .\\n\" +\n            \"  ?tc a <http://filteredpush.org/ontologies/oa/dwcFP#TaxonConcept> .\\n\" +\n            \"  ?augmentingTreatment treat:augmentsTaxonConcept ?tc .\\n\" +\n            \"  ?augmentingTreatment dc:creator ?augmentingTreatmentCreator .\" +\n            \"  ?definingTreatment treat:definesTaxonConcept ?tc .\\n\" +\n            \"  ?definingTreatment dc:creator ?definingTreatmentCreator .\\n\" +\n            \"} WHERE { \\n\" +\n            \"  ?tc dwc:rank ?rank .\\n\" +\n            \"  ?tc dwc:phylum ?phylum .\\n\" +\n            \"  ?tc dwc:kingdom ?kingdom .\\n\" +\n            \"  ?tc dwc:class ?class .\\n\" +\n            \"  ?tc dwc:family ?family .\\n\" +\n            \"  ?tc dwc:order ?oder .\\n\" +\n            \"  ?tc dwc:genus \\\"\" + genus + \"\\\" .\\n\" +\n            \"  ?tc dwc:species \\\"\" + species + \"\\\" .\\n\" +\n            \"  ?tc a <http://filteredpush.org/ontologies/oa/dwcFP#TaxonConcept> . \\n\" +\n            \"  OPTIONAL { ?augmentingTreatment treat:augmentsTaxonConcept ?tc . \\n\" +\n            \"  ?augmentingTreatment dc:creator ?augmentingTreatmentCreator .}\\n\" +\n            \"  OPTIONAL { ?definingTreatment treat:definesTaxonConcept ?tc . \\n\" +\n            \"  ?definingTreatment dc:creator ?definingTreatmentCreator .}\\n\" +\n            \"}\";\n    return sparqlEndpoint.getSparqlRDF(query).then(graph => {\n        let tnClass = GraphNode($rdf.sym(\"http://filteredpush.org/ontologies/oa/dwcFP#TaxonConcept\"), graph);\n        return tnClass.in($rdf.sym(\"http://www.w3.org/1999/02/22-rdf-syntax-ns#type\"));\n    });\n}\n\n\nfunction dwc(localName) {\n    return $rdf.sym(\"http://rs.tdwg.org/dwc/terms/\" + localName);\n}\n\nfunction treat(localName) {\n    return $rdf.sym(\"http://plazi.org/vocab/treatment#\" + localName);\n}\n\nfunction dc(localName) {\n    return $rdf.sym(\"http://purl.org/dc/elements/1.1/\" + localName);\n}\n\nlet addedImages = {};\nlet wikidataViewer = new WikidataViewer(document.getElementById(\"wikidata-area\"));\n\nfunction appendImages(taxon) {\n    getImages(taxon).then(images => {\n        var template = $('#imageTpl').html();\n        images.forEach(image => {\n            if (!addedImages[image.url]) {\n                addedImages[image.url] = true;\n                var html = Mustache.to_html(template, image);\n                $('#image-area').append(html);\n            }\n        });\n    });\n}\n\n\nfunction report(genus, species) {\n    function getFormattedName(uri) {\n        let nameSection = uri.substring(uri.lastIndexOf(\"/\") + 1);\n        let lastSeparator = nameSection.lastIndexOf(\"_\");\n        return nameSection.substring(0, lastSeparator).replace(new RegExp(\"_\", \"g\"), \" \") +\n                \", \" + nameSection.substring(lastSeparator + 1);\n    }\n    $('#taxon-name').html(\"\");\n    $('#image-area').html(\"\");\n    wikidataViewer.reset();\n    let names = {};\n    addedImages = {};\n    /* renders a graphnode (possibly one that represents multiple nodes)\n     */\n    function render(tns, title, target) {\n        tns.each(tn => tn).then(tns => Promise.all(tns.sort((tn1, tn2) => {\n                let y1 = tn1.value.substring(tn1.value.length - 4);\n                let y2 = tn2.value.substring(tn2.value.length - 4);\n                return y1 - y2;\n            }).map(async tn => {\n\n                //for unclear reasons some taxa have more than one family\n                let family = await tn.out(dwc(\"family\")).each(f => f.value).then(fs => fs.join(\", \"));\n\n                function linkToTreatments(gn) {\n                    return gn.each(t => t)\n                            .then(ts => Promise.all(ts.map(async t => \" <a href=\\\"\" + t.value + \"\\\">\" +\n                                            (await t.out(dc(\"creator\")).each(c => c.value)).join(\"; \") +\n                                            \"</a>\")).then(links => links.join(\" - \")));\n                }\n\n                let preferedNameByGN = tn.in(treat(\"preferedName\"));\n                let preferedNameBy = preferedNameByGN.nodes.length > 0 ? await linkToTreatments(preferedNameByGN) :\n                        \"\";\n\n                let definingTreatmentGN = tn.in(treat(\"definesTaxonConcept\"));\n                let definingTreatment = definingTreatmentGN.nodes.length > 0 ? \"Defined by: \" + await linkToTreatments(definingTreatmentGN) : \"Defining treatment not yet on plazi\";\n\n                let augmentingTreatmentGN = tn.in(treat(\"augmentsTaxonConcept\"));\n                let augmentingTreatment = augmentingTreatmentGN.nodes.length > 0 ? \"Augmented by: \" + await linkToTreatments(augmentingTreatmentGN) :\n                        \"\";\n\n                let result = $(\"<li>\").append(\"<strong>\" + getFormattedName(tn.value) + \"</strong>\" +\n                        preferedNameBy + \"<br/>\\n\" +\n                        \"Kingdom: \" + tn.out(dwc(\"kingdom\")).value + \" - Phylum: \" + tn.out(dwc(\"phylum\")).value +\n                        \" - Class: \" + tn.out(dwc(\"class\")).value + \" - Order: \" + tn.out(dwc(\"order\")).value +\n                        \" - Family: \" + family + \" - Genus: \" + tn.out(dwc(\"genus\")).value +\n                        \" - Species: \" + tn.out(dwc(\"species\")).value + \"<br/>\" + definingTreatment + \"<br/>\" + augmentingTreatment);\n                if (!names[tn.value]) {\n                    let deprecationsArea = $(\"<div class=\\\"deprecations\\\">looking for deprecations....</div>\");\n                    result = result.append(deprecationsArea)\n                    names[tn.value] = true;\n                    getNewTaxa(tn.value).then(newTaxa => {\n                        render(newTaxa,\"Deprecated by\", deprecationsArea);\n                        newTaxa.each(newTaxa => \n                            wikidataViewer.addTaxon(newTaxa.out(dwc(\"genus\")).value + \" \" + newTaxa.out(dwc(\"species\")).value)\n                        )\n                    });\n                }\n                appendImages(tn.value);\n                return result;\n            }))\n        ).then(listItems => {\n            if (listItems.length > 0) {\n                target.html(title).append($(\"<ul>\").append(listItems));\n            } else {\n                target.html(\"\");\n            }\n        });\n    }\n    getTaxonConcepts(genus, species).then(taxonConcepts => {\n        if (taxonConcepts.nodes.length === 0) {\n            $('#taxon-name').html(\"No treatment for \" + genus + \" \" + species + \" found on plazi.\");\n        } else {\n            window.location.hash = genus+\"+\"+species;\n            render(taxonConcepts,genus + \" \" + species, $('#taxon-name'));\n        }\n        wikidataViewer.addTaxon(genus + \" \" + species);\n    });\n}\n\n//Search field\n\nlet input = document.getElementById(\"combinedfield\");\nif (!input.value && window.location.hash) {\n    input.value = window.location.hash.substring(1).replace(\"+\",\" \");\n    lookup();\n}\nlet previousValue = input.value;\nlet gs = [];\nlet cs = [];\nlet ss = [];\n\nfunction lookup() {\n    $('#top-navbar').append($('#search-form'));\n    report(input.value.toString().substring(0, input.value.toString().indexOf(\" \")), input.value.toString().substr(input.value.toString().indexOf(\" \") + 1));\n}\n\n$(\"#lookup\").on(\"click\", e => {\n    lookup();\n    return false;\n});\n\nvar awesomplete = new Awesomplete(input);\nawesomplete.maxItems = 15;\nawesomplete.sort = false;\n\ninput.onkeyup = (e) => {\n    if ((input.value.length >= 2) && (e.key !== \"Enter\") && (input.value !== previousValue)) {\n        populateSuggestions();\n    }\n    return true;\n};\n\ninput.addEventListener(\"awesomplete-selectcomplete\", (e) => {\n    let wordCount = input.value.trim().split(\" \").length;\n    if (wordCount === 1) {\n        populateSuggestions();\n        awesomplete.open();\n    }\n    if (wordCount === 2) {\n        lookup();\n    }\n});\n\nfunction populateSuggestions() {\n    if (input.value.toString().indexOf(\" \") === -1) {\n        previousValue = input.value;\n        Promise.all([getGenusSuggestions(input.value), getCombinedSuggestions(input.value)]).then(v => {\n            gs = gs.map(i => i + \" \");\n            awesomplete.list = gs.concat(cs);\n        });\n    } else {\n        previousValue = input.value;\n        let speciesIn = input.value.toString().substr(input.value.toString().indexOf(\" \") + 1);\n        let genusIn = input.value.toString().substring(0, input.value.toString().indexOf(\" \"));\n        if (speciesIn.length > 0) {\n            getSpeciesSuggestions(speciesIn, genusIn).then(values => {\n                awesomplete.list = ss.map(i => genusIn + \" \" + i);\n            });\n        } else {\n            getSpeciesSuggestions(\"\", genusIn).then(values => {\n                awesomplete.list = ss.map(i => genusIn + \" \" + i);\n            });\n        }\n    }\n}\n\nawesomplete.filter = (t, i) => {\n    let foundPos = t.toLowerCase().indexOf(i.toLowerCase());\n    return (foundPos === 0) || (foundPos === (t.indexOf(\" \") + 1));\n};\n\nlet origItem = awesomplete.item;\nawesomplete.item = (suggestion, i) => {\n    let foundPos = suggestion.toLowerCase().indexOf(i.toLowerCase());\n    let suggestionSpacePos = suggestion.substr(0, suggestion.length - 1).indexOf(\" \");\n    let html;\n    if (suggestionSpacePos === -1) {\n        html = \"<mark>\" + suggestion.substring(0, i.length) + \"</mark>\" + suggestion.substring(i.length);\n    } else if (i.indexOf(\" \") === -1) {\n        html = suggestion.substring(0, suggestionSpacePos + 1) + \"<mark>\" +\n                suggestion.substring(suggestionSpacePos + 1, suggestionSpacePos + 1 + i.length) +\n                \"</mark>\" + suggestion.substring(suggestionSpacePos + 1 + i.length);\n    } else if (i.indexOf(\" \") !== -1) {\n        html = \"<mark>\" +\n                suggestion.substring(0, i.length) +\n                \"</mark>\" + suggestion.substring(i.length);\n    }\n    return $(\"<li aria-selected='false'>\" + html + \"</li>\")[0];\n};\n\n\n/**\n * \n * @param {type} prefix\n * @returns A promise for an array of matching genera\n */\nfunction getGenusSuggestions(prefix) {\n    let query = \"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\\n\" +\n            \"PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>\\n\" +\n            \"PREFIX dwcfp: <http://filteredpush.org/ontologies/oa/dwcFP#>\\n\" +\n            \"SELECT DISTINCT ?genus WHERE {\\n\" +\n            \" GRAPH <https://linked.opendata.swiss/graph/plazi> {\\n\" +\n            \"?sub dwc:genus ?genus .\\n\" +\n            \"?sub rdf:type dwcfp:TaxonName.\\n\" +\n            \"FILTER REGEX(?genus, \\\"^\" + prefix + \"\\\",\\\"i\\\")\\n\" +\n            \" }\\n\" +\n            \"} ORDER BY UCASE(?genus) LIMIT 10\";\n    return sparqlEndpoint.getSparqlResultSet(query).then(json => {\n        gs = json.results.bindings.map(binding => binding.genus.value);\n        return true;\n    });\n}\n\nfunction getSpeciesSuggestions(prefix, genus) {\n    let query = \"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\\n\" +\n            \"PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>\\n\" +\n            \"PREFIX dwcfp: <http://filteredpush.org/ontologies/oa/dwcFP#>\\n\" +\n            \"SELECT DISTINCT ?species WHERE {\\n\" +\n            \" GRAPH <https://linked.opendata.swiss/graph/plazi> {\\n\" +\n            \"?sub dwc:genus \\\"\" + genus + \"\\\" .\\n\" +\n            \"?sub dwc:species ?species .\\n\" +\n            \"?sub rdf:type dwcfp:TaxonName.\\n\" +\n            \"FILTER REGEX(?species, \\\"^\" + prefix + \"\\\",\\\"i\\\")\\n\" +\n            \" }\\n\" +\n            \"} ORDER BY UCASE(?species) LIMIT 10\";\n    return sparqlEndpoint.getSparqlResultSet(query).then(json => {\n        ss = json.results.bindings.map(binding => binding.species.value);\n        return true;\n    });\n}\n\nfunction getCombinedSuggestions(prefix) {\n    let query = \"PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>\\n\" +\n            \"PREFIX dwc: <http://rs.tdwg.org/dwc/terms/>\\n\" +\n            \"PREFIX dwcfp: <http://filteredpush.org/ontologies/oa/dwcFP#>\\n\" +\n            \"SELECT DISTINCT ?genus ?species WHERE {\\n\" +\n            \" GRAPH <https://linked.opendata.swiss/graph/plazi> {\\n\" +\n            \"?sub dwc:genus ?genus .\\n\" +\n            \"?sub dwc:species ?species .\\n\" +\n            \"?sub rdf:type dwcfp:TaxonName.\\n\" +\n            \"FILTER REGEX(?species, \\\"^\" + prefix + \"\\\",\\\"i\\\")\\n\" +\n            \" }\\n\" +\n            \"} ORDER BY UCASE(?species) LIMIT 10\";\n    return sparqlEndpoint.getSparqlResultSet(query).then(json => {\n        cs = json.results.bindings.map(binding => binding.genus.value + \" \" + binding.species.value);\n        return true;\n    });\n}\n"],"sourceRoot":""}